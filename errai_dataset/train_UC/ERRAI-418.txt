Entity types don't work as operands of JPQL =
In a query like this, where gl.owner is of type User (which is a JPA entity):

    SELECT gl FROM GroceryList gl WHERE gl.owner=:user

The following matcher code gets generated:

          public boolean matches(JSONObject candidate) {
            return Comparisons.nullSafeEquals(JsonUtil.basicValueFromJson(candidate.get("owner"), User.class), getParameterValue("user"));
          }

The problem is that in the generated code, "owner" is being retrieved as a JPA Basic value when in fact it's an entity reference.

The stack trace looks like this:

java.lang.RuntimeException: I don't know how unJSONify {"entityReference":"1"} (expected type class org.jboss.errai.demo.grocery.client.shared.User)
	at org.jboss.errai.jpa.client.local.JsonUtil.basicValueFromJson(JsonUtil.java:180)
	at org.jboss.errai.jpa.client.local.GeneratedErraiEntityManager$24$1.matches(GeneratedErraiEntityManager.java:1441)
	at org.jboss.errai.jpa.client.local.backend.WebStorageBackend$1.visit(WebStorageBackend.java:107)
	at sun.reflect.GeneratedMethodAccessor98.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at com.google.gwt.dev.shell.MethodAdaptor.invoke(MethodAdaptor.java:103)
	at com.google.gwt.dev.shell.MethodDispatch.invoke(MethodDispatch.java:71)
	at com.google.gwt.dev.shell.OophmSessionHandler.invoke(OophmSessionHandler.java:172)
	at com.google.gwt.dev.shell.BrowserChannelServer.reactToMessagesWhileWaitingForReturn(BrowserChannelServer.java:337)
	at com.google.gwt.dev.shell.BrowserChannelServer.invokeJavascript(BrowserChannelServer.java:218)
	at com.google.gwt.dev.shell.ModuleSpaceOOPHM.doInvoke(ModuleSpaceOOPHM.java:136)
	at com.google.gwt.dev.shell.ModuleSpace.invokeNative(ModuleSpace.java:561)
	at com.google.gwt.dev.shell.ModuleSpace.invokeNativeVoid(ModuleSpace.java:289)
	at com.google.gwt.dev.shell.JavaScriptHost.invokeNativeVoid(JavaScriptHost.java:107)
	at org.jboss.errai.jpa.client.local.backend.WebStorageBackend.forEachKey(WebStorageBackend.java)
	at org.jboss.errai.jpa.client.local.backend.WebStorageBackend.getAll(WebStorageBackend.java:97)
	at org.jboss.errai.jpa.client.local.ErraiEntityManager.findAll(ErraiEntityManager.java:448)
	at org.jboss.errai.jpa.client.local.ErraiTypedQuery.getResultList(ErraiTypedQuery.java:216)
	at org.jboss.errai.demo.grocery.client.local.GroceryListClient.getGroceryList(GroceryListClient.java:79)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at com.google.gwt.dev.shell.MethodAdaptor.invoke(MethodAdaptor.java:103)
	at com.google.gwt.dev.shell.MethodDispatch.invoke(MethodDispatch.java:71)
	at com.google.gwt.dev.shell.OophmSessionHandler.invoke(OophmSessionHandler.java:172)
	at com.google.gwt.dev.shell.BrowserChannelServer.reactToMessagesWhileWaitingForReturn(BrowserChannelServer.java:337)
	at com.google.gwt.dev.shell.BrowserChannelServer.invokeJavascript(BrowserChannelServer.java:218)
	at com.google.gwt.dev.shell.ModuleSpaceOOPHM.doInvoke(ModuleSpaceOOPHM.java:136)
	at com.google.gwt.dev.shell.ModuleSpace.invokeNative(ModuleSpace.java:561)
	at com.google.gwt.dev.shell.ModuleSpace.invokeNativeObject(ModuleSpace.java:269)
	at com.google.gwt.dev.shell.JavaScriptHost.invokeNativeObject(JavaScriptHost.java:91)
	at org.jboss.errai.ioc.client.BootstrapperImpl._481951962_getGroceryList(BootstrapperImpl.java)
	at org.jboss.errai.ioc.client.BootstrapperImpl$48$1.getInstance(BootstrapperImpl.java:756)
	at org.jboss.errai.ioc.client.BootstrapperImpl$48$1.getInstance(BootstrapperImpl.java:1)
	at org.jboss.errai.ioc.client.container.CreationalContext.getSingletonInstanceOrNew(CreationalContext.java:271)
	at org.jboss.errai.ioc.client.BootstrapperImpl$48.getInstance(BootstrapperImpl.java:761)
	at org.jboss.errai.ioc.client.BootstrapperImpl$48.getInstance(BootstrapperImpl.java:1)
	at org.jboss.errai.ioc.client.BootstrapperImpl$50.getInstance(BootstrapperImpl.java:793)
	at org.jboss.errai.ioc.client.BootstrapperImpl$50.getInstance(BootstrapperImpl.java:1)
	at org.jboss.errai.ioc.client.container.IOCDependentBean.getInstance(IOCDependentBean.java:90)
	at org.jboss.errai.ioc.client.container.IOCDependentBean.getInstance(IOCDependentBean.java:81)
	at org.jboss.errai.ui.nav.client.local.spi.GeneratedNavigationGraph$3.content(GeneratedNavigationGraph.java:48)
	at org.jboss.errai.ui.nav.client.local.Navigation.makePageVisible(Navigation.java:80)
	at org.jboss.errai.ui.nav.client.local.Navigation.goTo(Navigation.java:67)
	at org.jboss.errai.ui.nav.client.local.Navigation.init(Navigation.java:54)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at com.google.gwt.dev.shell.MethodAdaptor.invoke(MethodAdaptor.java:103)
	at com.google.gwt.dev.shell.MethodDispatch.invoke(MethodDispatch.java:71)
	at com.google.gwt.dev.shell.OophmSessionHandler.invoke(OophmSessionHandler.java:172)
	at com.google.gwt.dev.shell.BrowserChannelServer.reactToMessagesWhileWaitingForReturn(BrowserChannelServer.java:337)
	at com.google.gwt.dev.shell.BrowserChannelServer.invokeJavascript(BrowserChannelServer.java:218)
	at com.google.gwt.dev.shell.ModuleSpaceOOPHM.doInvoke(ModuleSpaceOOPHM.java:136)
	at com.google.gwt.dev.shell.ModuleSpace.invokeNative(ModuleSpace.java:561)
	at com.google.gwt.dev.shell.ModuleSpace.invokeNativeVoid(ModuleSpace.java:289)
	at com.google.gwt.dev.shell.JavaScriptHost.invokeNativeVoid(JavaScriptHost.java:107)
	at org.jboss.errai.ioc.client.BootstrapperImpl._136504311_init(BootstrapperImpl.java)
	at org.jboss.errai.ioc.client.BootstrapperImpl$19.init(BootstrapperImpl.java:334)
	at org.jboss.errai.ioc.client.BootstrapperImpl$19.init(BootstrapperImpl.java:1)
	at org.jboss.errai.ioc.client.container.CreationalContext.fireAllInitCallbacks(CreationalContext.java:323)
	at org.jboss.errai.ioc.client.container.CreationalContext.finish(CreationalContext.java:313)
	at org.jboss.errai.ioc.client.Container.bootstrapContainer(Container.java:59)
	at org.jboss.errai.ioc.client.Container.onModuleLoad(Container.java:34)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at com.google.gwt.dev.shell.ModuleSpace.onLoad(ModuleSpace.java:396)
	at com.google.gwt.dev.shell.OophmSessionHandler.loadModule(OophmSessionHandler.java:200)
	at com.google.gwt.dev.shell.BrowserChannelServer.processConnection(BrowserChannelServer.java:525)
	at com.google.gwt.dev.shell.BrowserChannelServer.run(BrowserChannelServer.java:363)
	at java.lang.Thread.run(Thread.java:680)
